
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="https://cdn.ifne.eu/public/icons/dnation_k8sm8g.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.7">
    
    
      
        <title>FAQ - dNation Kubernetes Monitoring</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.19753c6b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.196e0c26.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../docs/docs.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#frequently-asked-questions-faq" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="dNation Kubernetes Monitoring" class="md-header-nav__button md-logo" aria-label="dNation Kubernetes Monitoring">
      
  <img src="https://cdn.ifne.eu/public/icons/dnation_k8sm8g.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            dNation Kubernetes Monitoring
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              FAQ
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/dNationCloud/kubernetes-monitoring" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    dNationCloud/kubernetes-monitoring
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="dNation Kubernetes Monitoring" class="md-nav__button md-logo" aria-label="dNation Kubernetes Monitoring">
      
  <img src="https://cdn.ifne.eu/public/icons/dnation_k8sm8g.png" alt="logo">

    </a>
    dNation Kubernetes Monitoring
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/dNationCloud/kubernetes-monitoring" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    dNationCloud/kubernetes-monitoring
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../docs/documentation/" class="md-nav__link">
      Docs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../docs/AWS_doc/" class="md-nav__link">
      AWS
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        FAQ
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      FAQ
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-interpret-displayed-monitoring-values-across-different-monitoring-layers" class="md-nav__link">
    How to interpret displayed monitoring values across different monitoring layers?
  </a>
  
    <nav class="md-nav" aria-label="How to interpret displayed monitoring values across different monitoring layers?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monitoring-layer-0" class="md-nav__link">
    Monitoring Layer 0
  </a>
  
    <nav class="md-nav" aria-label="Monitoring Layer 0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kubernetes-monitoring" class="md-nav__link">
    Kubernetes monitoring
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-monitoring" class="md-nav__link">
    Host monitoring
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8s-monitoring-layer-1" class="md-nav__link">
    K8s monitoring Layer 1
  </a>
  
    <nav class="md-nav" aria-label="K8s monitoring Layer 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alerts" class="md-nav__link">
    Alerts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#control-plane-components" class="md-nav__link">
    Control Plane Components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-metrics-including-master" class="md-nav__link">
    Node Metrics (including Master)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applications" class="md-nav__link">
    Applications
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8s-monitoring-lower-layers" class="md-nav__link">
    K8s monitoring lower layers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-monitoring-layer-1" class="md-nav__link">
    Host monitoring Layer 1
  </a>
  
    <nav class="md-nav" aria-label="Host monitoring Layer 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alerts_1" class="md-nav__link">
    Alerts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host" class="md-nav__link">
    Host
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applications_1" class="md-nav__link">
    Applications
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-monitoring-lower-layers" class="md-nav__link">
    Host monitoring lower layers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-set-up-k8s-cluster-monitoring" class="md-nav__link">
    How to set up k8s cluster monitoring?
  </a>
  
    <nav class="md-nav" aria-label="How to set up k8s cluster monitoring?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    Set up
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-customize-my-k8s-monitoring" class="md-nav__link">
    How to customize my k8s monitoring?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-set-up-k8s-application-monitoring" class="md-nav__link">
    How to set up k8s application monitoring?
  </a>
  
    <nav class="md-nav" aria-label="How to set up k8s application monitoring?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites_1" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up_1" class="md-nav__link">
    Set up
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-set-up-host-monitoring" class="md-nav__link">
    How to set up host monitoring?
  </a>
  
    <nav class="md-nav" aria-label="How to set up host monitoring?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites_2" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up_2" class="md-nav__link">
    Set up
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-customize-my-host-monitoring" class="md-nav__link">
    How to customize my host monitoring?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-set-up-host-application-monitoring" class="md-nav__link">
    How to set up host application monitoring?
  </a>
  
    <nav class="md-nav" aria-label="How to set up host application monitoring?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites_3" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up_3" class="md-nav__link">
    Set up
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-l2-table-item-has-different-background-color-as-corresponding-l1-stat-panel" class="md-nav__link">
    Why L2 table item has different background color as corresponding L1 stat panel?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-monitoring-shows-down-state-for-some-control-plane-components-are-control-plane-components-working-correctly" class="md-nav__link">
    Kubernetes Monitoring shows DOWN state for some control plane components. Are control plane components working correctly?
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-interpret-displayed-monitoring-values-across-different-monitoring-layers" class="md-nav__link">
    How to interpret displayed monitoring values across different monitoring layers?
  </a>
  
    <nav class="md-nav" aria-label="How to interpret displayed monitoring values across different monitoring layers?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monitoring-layer-0" class="md-nav__link">
    Monitoring Layer 0
  </a>
  
    <nav class="md-nav" aria-label="Monitoring Layer 0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kubernetes-monitoring" class="md-nav__link">
    Kubernetes monitoring
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-monitoring" class="md-nav__link">
    Host monitoring
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8s-monitoring-layer-1" class="md-nav__link">
    K8s monitoring Layer 1
  </a>
  
    <nav class="md-nav" aria-label="K8s monitoring Layer 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alerts" class="md-nav__link">
    Alerts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#control-plane-components" class="md-nav__link">
    Control Plane Components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-metrics-including-master" class="md-nav__link">
    Node Metrics (including Master)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applications" class="md-nav__link">
    Applications
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k8s-monitoring-lower-layers" class="md-nav__link">
    K8s monitoring lower layers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-monitoring-layer-1" class="md-nav__link">
    Host monitoring Layer 1
  </a>
  
    <nav class="md-nav" aria-label="Host monitoring Layer 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alerts_1" class="md-nav__link">
    Alerts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host" class="md-nav__link">
    Host
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applications_1" class="md-nav__link">
    Applications
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-monitoring-lower-layers" class="md-nav__link">
    Host monitoring lower layers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-set-up-k8s-cluster-monitoring" class="md-nav__link">
    How to set up k8s cluster monitoring?
  </a>
  
    <nav class="md-nav" aria-label="How to set up k8s cluster monitoring?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    Set up
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-customize-my-k8s-monitoring" class="md-nav__link">
    How to customize my k8s monitoring?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-set-up-k8s-application-monitoring" class="md-nav__link">
    How to set up k8s application monitoring?
  </a>
  
    <nav class="md-nav" aria-label="How to set up k8s application monitoring?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites_1" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up_1" class="md-nav__link">
    Set up
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-set-up-host-monitoring" class="md-nav__link">
    How to set up host monitoring?
  </a>
  
    <nav class="md-nav" aria-label="How to set up host monitoring?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites_2" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up_2" class="md-nav__link">
    Set up
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-customize-my-host-monitoring" class="md-nav__link">
    How to customize my host monitoring?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-set-up-host-application-monitoring" class="md-nav__link">
    How to set up host application monitoring?
  </a>
  
    <nav class="md-nav" aria-label="How to set up host application monitoring?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites_3" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up_3" class="md-nav__link">
    Set up
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-l2-table-item-has-different-background-color-as-corresponding-l1-stat-panel" class="md-nav__link">
    Why L2 table item has different background color as corresponding L1 stat panel?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-monitoring-shows-down-state-for-some-control-plane-components-are-control-plane-components-working-correctly" class="md-nav__link">
    Kubernetes Monitoring shows DOWN state for some control plane components. Are control plane components working correctly?
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="frequently-asked-questions-faq">Frequently Asked Questions (FAQ)</h1>
<h2 id="how-to-interpret-displayed-monitoring-values-across-different-monitoring-layers">How to interpret displayed monitoring values across different monitoring layers?</h2>
<h3 id="monitoring-layer-0">Monitoring Layer 0</h3>
<p><img alt="l0" src="../../docs/images/l0.png" /></p>
<h4 id="kubernetes-monitoring">Kubernetes monitoring</h4>
<p>Kubernetes cluster health is simply represented by the single state panel. State panel aggregates alerts from the 
underlying layer of kubernetes monitoring. The healthy status is represented by the green state panel with 'OK' label. It is displayed if the k8s cluster meets all the defined thresholds for healthy status.
When some threshold is crossed and this state  persists for <strong>5</strong> minutes (default), relevant alert is triggered and highlighted.
The orange state panel  with <code>Warning</code> label is displayed in case of warning alert. Red state panel with  <code>Critical</code> label is displayed in case of critical alert.
We have implemented intuitive green, orange and red color indicators that are signalizing if your action is needed or if everything is OK.
If you want to see more information about your k8s cluster, just drill down by left-clicking on
the relevant state panel. As of now, only single cluster monitoring is supported. Multi cluster monitoring support is under development.
- If you are interested in the k8s cluster monitoring see <a href="#how-to-set-up-k8s-cluster-monitoring">How to set up k8s cluster monitoring?</a> section.</p>
<h4 id="host-monitoring">Host monitoring</h4>
<p>Host monitoring integration allows you to monitor your hosts infrastructure within our kubernetes based, 
stable and highly available monitoring. Hosts state panel functions on the same principles as k8s cluster state panel. Multi host 
monitoring is supported.
- If you are interested in the host monitoring see <a href="#how-to-set-up-host-monitoring">How to set up host monitoring?</a> section.</p>
<h3 id="k8s-monitoring-layer-1">K8s monitoring Layer 1</h3>
<p><img alt="l1_k8s" src="../../docs/images/l1_k8s.png" />
The first layer of k8s monitoring consists of state panels that visualize the current state of your k8s cluster. The state
panels are separated into several sections:
- Alerts
- Overview
- Control Plane Components Health
- Node Metrics (including Master)
- Applications (optional)</p>
<p>When a failed condition of monitored k8s element occurs the state panel shows lowered percentage value on health indicator. If the state of health is too 
low and the percentage value reached warning or even critical threshold, corresponding state panel changes its color.
Intuitive green, orange and red color principle is used. When failed state lasts longer than <strong>5</strong> minutes (default) then 
the relevant alert is triggered and highlighted in alert panel. Also the panel representing the overall health of the k8s cluster in the monitoring layer 0 changes accordingly.
The first layer is the source of all aggregated k8s cluster alerts triggered by dNation monitoring.</p>
<h4 id="alerts">Alerts</h4>
<p>The upper section shows the amount of triggered critical and warning alerts. If you want to see detailed list of 
triggered alerts simply apply the drill down principle.</p>
<h4 id="overview">Overview</h4>
<p>The overview section allows you to monitor the health status of k8s nodes, workloads (deployments, stateful sets, daemon sets, pods, containers and more)
and persistent volumes. Each state panel contains important information of monitored k8s element, e.g. single node health state panel
gives you an insight on whether the k8s nodes are able to schedule resources or if they are under disk, memory or PID pressure.</p>
<h4 id="control-plane-components">Control Plane Components</h4>
<p>Monitoring of k8s cluster control plane components (api server, controller manager, etcd database, kubelet, proxy and scheduler) 
is located in separate section. If you want to check the work queue rate of controller manager or scheduler latency, the Control Plane Components section is the section you are looking for.</p>
<h4 id="node-metrics-including-master">Node Metrics (including Master)</h4>
<p>Measuring k8s nodes system metrics is important in ensuring k8s cluster availability. Node Metrics section gives you a clear overview
of cluster's CPU, memory, disk and network utilization. Each system metric is visualized in several state panels such as overall (average) utilization panel, the most utilized cluster node panel and information panels which show
used and total state of system metrics. It is always useful to know overall cluster utilization, but it is also important to know when one node is utilized more than other nodes which may indicates that your
k8s cluster doesn't work properly.
If you want to drill down for further investigation of your k8s node you can select between <code>System Overview</code> or <code>K8s Overview</code> buttons.
<code>System Overview</code> shows CPU, memory, disk and network utilization per k8s cluster node in greater detail.
<code>K8s Overview</code> shows systems resource usage in k8s oriented manner, meaning that you can filter particular k8s workload per k8s cluster node
or see information about CPU and memory requests and limits.</p>
<h4 id="applications">Applications</h4>
<p>In order to thoroughly understand application health, we created custom dashboards which help us to
properly understand and diagnose application workloads in k8s cluster. As of today we have designed several dashboards for well known and widely used 
frameworks such as java actuator, python flask, nginx ingress controller and more. Layer 1 state panels aggregate 
important information of monitored application. Green, orange and red color principle informs us if there is action needed and
drill down principle can be used to access verbose and detailed application dashboard. </p>
<ul>
<li>If you want to customize your L1 layer see <a href="#how-to-customize-my-k8s-monitoring">How to customize my k8s monitoring?</a> section.</li>
<li>If you are interested in the k8s application monitoring see <a href="#how-to-set-up-k8s-application-monitoring">How to set up k8s application monitoring?</a> section.</li>
</ul>
<h3 id="k8s-monitoring-lower-layers">K8s monitoring lower layers</h3>
<p>If you want to know details on why is particular stat panel in upper layer green, orange or red, just drill down.
Look at some examples from layer 2 and layer 3 of k8s monitoring:</p>
<ul>
<li>K8s monitoring Layer 2 example</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: center;">Containers</th>
<th style="text-align: center;">Node Disks</th>
<th style="text-align: center;">Application</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><img alt="l2_k8s_container" src="../../docs/images/l2_k8s_container.png" /></td>
<td style="text-align: center;"><img alt="l2_k8s_disk" src="../../docs/images/l2_k8s_disk.png" /></td>
<td style="text-align: center;"><img alt="l2_k8s_app" src="../../docs/images/l2_k8s_app.png" /></td>
</tr>
</tbody>
</table>
<ul>
<li>K8s monitoring Layer 3 example</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: center;">Containers</th>
<th style="text-align: center;">Nodes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><img alt="l3_k8s_container" src="../../docs/images/l3_k8s_container.png" /></td>
<td style="text-align: center;"><img alt="l3_k8s_node" src="../../docs/images/l3_k8s_node.png" /></td>
</tr>
</tbody>
</table>
<h3 id="host-monitoring-layer-1">Host monitoring Layer 1</h3>
<p><img alt="l1_host" src="../../docs/images/l1_host.png" />
The first layer of host monitoring consists of state panels that visualize the current state of your host. The state
panels are separated into several sections:
- Alerts
- Host
- Applications (optional)</p>
<p>When a failed condition of monitored host element occurs the state panel shows lowered percentage value on health indicator. If the state of health is too
low and the percentage value reached warning or even critical threshold, corresponding state panel changes its color.
Intuitive green, orange and red color principle is used. When failed state lasts longer than <strong>5</strong> minutes (default) then 
the relevant alert is triggered and highlighted in alert panel. Also the panel representing the overall health of the host in the monitoring layer 0 changes accordingly.
The first layer is the source of all aggregated hosts alerts triggered by dNation monitoring.</p>
<h4 id="alerts_1">Alerts</h4>
<p>The upper section shows the amount of triggered critical and warning alerts. If you want to see detailed list of 
triggered alerts simply apply the drill down principle.</p>
<h4 id="host">Host</h4>
<p>Host section gives you clear overview of host's CPU, memory, disk and network utilization.
Each system metric is visualized in several state panels. The main host overall utilization panel and information panels show
used and total state of system metric.</p>
<h4 id="applications_1">Applications</h4>
<p>In order to thoroughly understand application health, we created custom dashboards which help us to
properly understand and diagnose host applications. As of today, we have designed several dashboards such as cadvisor.
Layer 1 state panels aggregate important information of monitored application. Green, orange and red color principle
informs us if there is some action needed and drill down principle can be used to access verbose and detailed application dashboard.</p>
<ul>
<li>If you want to customize your L1 layer by custom host monitoring template definition, see <a href="#how-to-customize-my-host-monitoring">How to customize my host monitoring?</a> section.</li>
<li>If you are interested in the host application monitoring, see <a href="#how-to-set-up-host-application-monitoring">How to set up host application monitoring?</a> section.</li>
</ul>
<h3 id="host-monitoring-lower-layers">Host monitoring lower layers</h3>
<p>If you want to know details why is some stats panel in upper layer green, orange or red, just drill down and click it.
See some examples from layer 2 of host monitoring:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Host Detail</th>
<th style="text-align: center;">Application</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><img alt="l2_host_node" src="../../docs/images/l2_host_node.png" /></td>
<td style="text-align: center;"><img alt="l2_host_app" src="../../docs/images/l2_host_app.png" /></td>
</tr>
</tbody>
</table>
<h2 id="how-to-set-up-k8s-cluster-monitoring">How to set up k8s cluster monitoring?</h2>
<h3 id="prerequisites">Prerequisites</h3>
<p>Install dNation k8s monitoring on k8s cluster. See installation steps <a href="https://github.com/dNationCloud/kubernetes-monitoring#full-installation">here</a>. </p>
<h3 id="set-up">Set up</h3>
<p>K8s cluster monitoring is enabled by default. See the <a href="https://dnationcloud.github.io/kubernetes-monitoring/docs/documentation/#clustermonitoring">docs</a>:
<div class="highlight"><pre><span></span><code><span class="nt">clusterMonitoring</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">clusters</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">K8sCluster</span><span class="w"></span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Kubernetes</span><span class="nv"> </span><span class="s">cluster</span><span class="nv"> </span><span class="s">monitoring&#39;</span><span class="w"></span>
<span class="w">    </span><span class="nt">apps</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span><span class="w"></span>
</code></pre></div>
It means that your k8s cluster is being monitored right after installation of dNation k8s monitoring.
If you want to customize k8s cluster monitoring see <a href="#how-to-customize-my-k8s-monitoring">How to customize my k8s monitoring?</a> section.</p>
<h2 id="how-to-customize-my-k8s-monitoring">How to customize my k8s monitoring?</h2>
<p>We understand that each k8s cluster may contain various workloads or implement various scaling strategies.
We tried to do our best and set up suitable defaults based on our production environment experiences, but we know that 
isn't possible cover the variety of k8s cluster configurations. To tackle this problem, we implemented template logic that allows you to
fully customize the default state panels or alerts. You can also create your own to fulfill your k8s cluster monitoring requirements.
Currently only first layer is customizable, however, the templating of other layers is under development.
For full list of k8s templates see the <a href="https://dnationcloud.github.io/kubernetes-monitoring/docs/documentation/#templates">docs</a>.</p>
<p>If you want to customize default layer 1 template in k8s monitoring just create a simple yaml file:
<div class="highlight"><pre><span></span><code><span class="nt">templates</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">k8s</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Override stats panel title and warning thresholds for the etcd health panel</span><span class="w"></span>
<span class="w">    </span><span class="nt">etcdHealth</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">panel</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Custom</span><span class="nv"> </span><span class="s">Title&quot;</span><span class="w"></span>
<span class="w">        </span><span class="nt">thresholds</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">warning</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">96</span><span class="w"></span>
<span class="w">      </span><span class="nt">alert</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">thresholds</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">warning</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">96</span><span class="w"></span>
</code></pre></div>
Each state panel that can be modified contains a template name in its description for easy navigation:</p>
<p><img alt="l1_k8s_etcd_hover.png" src="../../docs/images/l1_k8s_etcd_hover.png" /></p>
<p>Finally, update your k8s monitoring deployment and override the default monitoring configuration:
<div class="highlight"><pre><span></span><code>helm upgrade <span class="o">[</span>RELEASE<span class="o">]</span> <span class="o">[</span>CHART<span class="o">]</span> -f override.yaml
</code></pre></div>
If you want to create your own custom template see full examples in the <code>helpers</code> directory.</p>
<h2 id="how-to-set-up-k8s-application-monitoring">How to set up k8s application monitoring?</h2>
<h3 id="prerequisites_1">Prerequisites</h3>
<p>Enable or install metrics exporter in your k8s application.</p>
<h3 id="set-up_1">Set up</h3>
<p>K8s application monitoring is disabled by default. See the <a href="https://dnationcloud.github.io/kubernetes-monitoring/docs/documentation/#clustermonitoring">docs</a>.
To enable it just create application monitoring definition as follows:
<div class="highlight"><pre><span></span><code><span class="nt">clusterMonitoring</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">clusters</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">K8sCluster</span><span class="w"></span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Kubernetes</span><span class="nv"> </span><span class="s">cluster</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">application</span><span class="nv"> </span><span class="s">monitoring&#39;</span><span class="w"></span>
<span class="w">    </span><span class="nt">apps</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-example</span><span class="w"></span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Example of App Monitoring</span><span class="w"></span>
<span class="w">      </span><span class="nt">jobName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flask-app</span><span class="w">  </span><span class="c1"># The job name should be the same as the name which will be retrieved from the `jobLabel`, see the `serviceMonitor` section</span><span class="w"></span>
<span class="w">      </span><span class="nt">templates</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">javaActuator</span><span class="p">:</span><span class="w">  </span><span class="c1"># Application Exporter template</span><span class="w"></span>
<span class="w">          </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">      </span><span class="nt">serviceMonitor</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">jobLabel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span><span class="w"> </span><span class="c1"># The label to use to retrieve the job name from.</span><span class="w"></span>
<span class="w">        </span><span class="nt">namespaceSelector</span><span class="p">:</span><span class="w">  </span><span class="c1"># Namespaces to transfer from the kubernetes service to the target</span><span class="w"></span>
<span class="w">          </span><span class="nt">matchNames</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span><span class="w"></span>
<span class="w">        </span><span class="nt">selector</span><span class="p">:</span><span class="w">  </span><span class="c1"># Label selector for services to which this ServiceMonitor applies</span><span class="w"></span>
<span class="w">          </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flask-app</span><span class="w"></span>
<span class="w">        </span><span class="c1"># Endpoints of the selected service to be monitored</span><span class="w"></span>
<span class="w">        </span><span class="c1"># ref: https://github.com/prometheus-operator/prometheus-operator/blob/master/Documentation/api.md#endpoint</span><span class="w"></span>
<span class="w">        </span><span class="nt">endpoints</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metrics</span><span class="w">  </span><span class="c1"># Name or number of the endpoint&#39;s target port</span><span class="w"></span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/metrics</span><span class="w">  </span><span class="c1"># HTTP path to scrape for metrics</span><span class="w"></span>
</code></pre></div></p>
<p>Application monitoring definition contains two main sections: <code>template</code> and <code>serviceMonitor</code> or <code>podMonitor</code> respectively.
The <code>template</code> section defines which template and pre-defined application dashboard will be used.
For full list of pre-defined k8s application templates see the <a href="https://dnationcloud.github.io/kubernetes-monitoring/docs/documentation/#k8sapps">docs</a>.
Application monitoring metrics endpoint is auto-discovered by <a href="https://github.com/prometheus-operator/prometheus-operator/blob/master/Documentation/api.md#servicemonitor">service monitor</a> 
or by <a href="https://github.com/prometheus-operator/prometheus-operator/blob/master/Documentation/api.md#podmonitor">pod monitor</a> CRDs.
See the documentation of CRDs to ensure that your application metrics endpoint will be discovered as you want or find some 
examples in <code>helpers</code> directory.</p>
<p>Finally, update your k8s monitoring deployment and apply the application monitoring configuration:
<div class="highlight"><pre><span></span><code>helm upgrade <span class="o">[</span>RELEASE<span class="o">]</span> <span class="o">[</span>CHART<span class="o">]</span> -f apps.yaml
</code></pre></div>
- If you want to customize the default application template see <a href="#how-to-customize-my-k8s-monitoring">How to customize my k8s monitoring?</a> section.</p>
<h2 id="how-to-set-up-host-monitoring">How to set up host monitoring?</h2>
<h3 id="prerequisites_2">Prerequisites</h3>
<p>Enable or install <a href="https://github.com/prometheus/node_exporter">node exporter</a> in your host. You can use <code>helpers/node_exporter.sh</code> installation script.</p>
<h3 id="set-up_2">Set up</h3>
<p>Host monitoring is disabled by default. See the <a href="https://dnationcloud.github.io/kubernetes-monitoring/docs/documentation/#hostmonitoring">docs</a>.
To enable it just create host monitoring definition as follows:
<div class="highlight"><pre><span></span><code><span class="nt">hostMonitoring</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host-01</span><span class="w"></span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Host 01</span><span class="w"></span>
<span class="w">    </span><span class="nt">jobName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host-01</span><span class="w"></span>
<span class="w">    </span><span class="nt">host</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.1</span><span class="w">  </span><span class="c1"># Host IP address</span><span class="w"></span>
<span class="w">    </span><span class="nt">serviceMonitor</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">endpoints</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9100</span><span class="w">  </span><span class="c1"># Node exporter port</span><span class="w"></span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/metrics</span><span class="w">  </span><span class="c1"># Node exporter metrics path</span><span class="w"></span>
</code></pre></div>
Host monitoring definition contains two main sections: <code>host</code> and <code>serviceMonitor</code>.
The <code>host</code> section simply defines the host IP address. The <code>serviceMonitor</code> defines <a href="https://github.com/prometheus-operator/prometheus-operator/blob/master/Documentation/api.md#servicemonitor">service monitor</a>
CRD endpoint i.e. the host's node exporter port and path. Lot of service monitor parameters are pre-configured to simplify host monitoring configuration. If you are interested how or you want to 
override some of these parameters see the <code>chart/templates/hosts</code> directory. </p>
<p>Finally, update your k8s monitoring deployment and apply the host monitoring configuration:
<div class="highlight"><pre><span></span><code>helm upgrade <span class="o">[</span>RELEASE<span class="o">]</span> <span class="o">[</span>CHART<span class="o">]</span> -f host.yaml
</code></pre></div></p>
<h2 id="how-to-customize-my-host-monitoring">How to customize my host monitoring?</h2>
<p>To cover variety of host configurations we implemented the template logic in the host monitoring as well. Templates allow you to
fully customize the default state panels or alerts. You can also create your own to fulfill your host monitoring requirements.
Currently, layer 1 customization is implemented. For full list of host templates see the <a href="https://dnationcloud.github.io/kubernetes-monitoring/docs/documentation/#templates">docs</a>.</p>
<p>If you want to customize default layer 1 template in host monitoring just create a simple yaml file:
<div class="highlight"><pre><span></span><code><span class="nt">templates</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Override warning thresholds for the CPU utilization panel</span><span class="w"></span>
<span class="w">    </span><span class="nt">overallUtilizationCPU</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">panel</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">thresholds</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">warning</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span><span class="w"></span>
<span class="w">      </span><span class="nt">alert</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">thresholds</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">warning</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span><span class="w"></span>
</code></pre></div>
Each state panel that can be modified contains a template name in its description for easy navigation:</p>
<p><img alt="l1_host_cpu_hover.png" src="../../docs/images/l1_host_cpu_hover.png" /></p>
<p>Finally, update your k8s monitoring deployment and override the default monitoring configuration:
<div class="highlight"><pre><span></span><code>helm upgrade <span class="o">[</span>RELEASE<span class="o">]</span> <span class="o">[</span>CHART<span class="o">]</span> -f override.yaml
</code></pre></div>
If you want to create your own custom template see full examples in the <code>helpers</code> directory.</p>
<h2 id="how-to-set-up-host-application-monitoring">How to set up host application monitoring?</h2>
<h3 id="prerequisites_3">Prerequisites</h3>
<p>Enable or install metrics exporter in your host application.</p>
<h3 id="set-up_3">Set up</h3>
<p>Hosts application monitoring is disabled by default. See the <a href="https://dnationcloud.github.io/kubernetes-monitoring/docs/documentation/#hostmonitoring">docs</a>.
To enable it just create application monitoring definition as follows:
<div class="highlight"><pre><span></span><code><span class="nt">hostMonitoring</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host-01</span><span class="w"></span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Host</span><span class="nv"> </span><span class="s">01</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">application</span><span class="nv"> </span><span class="s">monitoring&#39;</span><span class="w"></span>
<span class="w">    </span><span class="nt">host</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.2.3.4</span><span class="w"></span>
<span class="w">    </span><span class="nt">apps</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host-01-docker</span><span class="w"></span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Host 01 Docker Containers</span><span class="w"></span>
<span class="w">      </span><span class="nt">jobName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host-01-docker</span><span class="w"></span>
<span class="w">      </span><span class="nt">templates</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">cAdvisor</span><span class="p">:</span><span class="w">  </span><span class="c1"># Application Exporter template</span><span class="w"></span>
<span class="w">          </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">      </span><span class="nt">serviceMonitor</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">endpoints</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9101</span><span class="w">  </span><span class="c1"># Application exporter port</span><span class="w"></span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/metrics</span><span class="w">  </span><span class="c1"># Application exporter metrics path</span><span class="w"></span>
</code></pre></div></p>
<p>Application monitoring definition contains two main sections: <code>template</code> and <code>serviceMonitor</code>.
The <code>template</code> section defines which template and pre-defined application dashboard will be used.
For full list of pre-defined host application templates see the <a href="https://dnationcloud.github.io/kubernetes-monitoring/docs/documentation/#hostapps">docs</a>.
The <code>serviceMonitor</code> defines <a href="https://github.com/prometheus-operator/prometheus-operator/blob/master/Documentation/api.md#servicemonitor">service monitor</a>
CRD endpoint, i.e. the application's exporter port and path. Lot of service monitor parameters are pre-configured to simplify application monitoring configuration. If you are curious how or you want to 
override some of these parameters see the <code>chart/templates/hosts</code> directory or find some examples in <code>helpers</code> directory.</p>
<p>Finally, update your k8s monitoring deployment and apply the application monitoring configuration:
<div class="highlight"><pre><span></span><code>helm upgrade <span class="o">[</span>RELEASE<span class="o">]</span> <span class="o">[</span>CHART<span class="o">]</span> -f apps.yaml
</code></pre></div>
- If you want to customize the default application template see the <a href="#how-to-customize-my-host-monitoring">How to customize my host monitoring?</a> section.</p>
<h2 id="why-l2-table-item-has-different-background-color-as-corresponding-l1-stat-panel">Why L2 table item has different background color as corresponding L1 stat panel?</h2>
<p>If you <a href="#how-to-customize-my-k8s-monitoring">customized your k8s monitoring</a>, you can see that some
table items on L2 layer dashboard may have different background color as corresponding L1 stat panel.</p>
<p>Example:
- Define custom L1 PVC utilization panel with custom thresholds for ELK PVCs
<img alt="l1_k8s_elk_pvc.png" src="../../docs/images/l1_k8s_elk_pvc.png" />
- If you drill down, you can see that corresponding PVC capacity is in <em>Critical</em> state (orange background color)
<img alt="l2_k8s_elk_pvc.png" src="../../docs/images/l2_k8s_elk_pvc.png" /></p>
<p>Currently only first layer is customizable, which caused this unexpected behaviour.
Templating of other layers is under development and is planned in <a href="https://github.com/issues?q=is%3Aopen+is%3Aissue+author%3Amatofeder+archived%3Afalse+label%3Av1.1.x">v1.1.x release</a>.</p>
<h2 id="kubernetes-monitoring-shows-down-state-for-some-control-plane-components-are-control-plane-components-working-correctly">Kubernetes Monitoring shows <code>DOWN</code> state for some control plane components. Are control plane components working correctly?</h2>
<p>Control plane components work probably well, but their metrics server might be disabled or misconfigured.
You should want  to check address bindings of control plane components' metrics as follows:</p>
<p>The metrics of <code>etcd</code> and <code>kube-proxy</code> control plane components are by default
bound to the localhost that prometheus instances <strong>cannot</strong> access.
Also make sure metrics of <code>scheduler</code> and <code>controller-manager</code> control plane
components don't have the same address binding if you want to collect them.</p>
<p>Edit and use <code>kubeadm_init.yaml</code> file to configure <code>kubeadm init</code> in case of fresh K8s deployment.</p>
<div class="highlight"><pre><span></span><code>kubeadm init --config<span class="o">=</span>helpers/kubeadm_init.yaml
</code></pre></div>
<p>Manual setup in case of already running K8s deployment.</p>
<ul>
<li>
<p>Setup <code>etcd</code> metrics bind address
    <div class="highlight"><pre><span></span><code><span class="c1"># On k8s master node</span>
<span class="nb">cd</span> /etc/kubernetes/manifests/
sudo vim etcd.yaml
<span class="c1"># Add listen-metrics-urls as etcd command option</span>
...
- --listen-metrics-urls<span class="o">=</span>http://0.0.0.0:2381
...
</code></pre></div></p>
</li>
<li>
<p>Setup <code>kube-proxy</code> metrics bind address</p>
<p>Edit kube-proxy daemon set
<div class="highlight"><pre><span></span><code>kubectl edit ds kube-proxy -n kube-system
...containers:
      - command:
        - /usr/local/bin/kube-proxy
        - --config<span class="o">=</span>/var/lib/kube-proxy/config.conf
        - --hostname-override<span class="o">=</span><span class="k">$(</span>NODE_NAME<span class="k">)</span>
        - --metrics-bind-address<span class="o">=</span><span class="m">0</span>.0.0.0  <span class="c1"># Add metrics-bind-address line</span>
</code></pre></div>
Edit kube-proxy config map
<div class="highlight"><pre><span></span><code>kubectl -n kube-system edit cm kube-proxy
...
    kind: KubeProxyConfiguration
    metricsBindAddress: <span class="s2">&quot;0.0.0.0:10249&quot;</span> <span class="c1"># Add metrics-bind-address host:port</span>
    mode: <span class="s2">&quot;&quot;</span>
</code></pre></div>
Delete the kube-proxy pods and reapply the new configuration
<div class="highlight"><pre><span></span><code>kubectl -n kube-system delete po -l k8s-app<span class="o">=</span>kube-proxy
</code></pre></div></p>
</li>
<li>
<p>Setup <code>scheduler</code> metrics bind address
    <div class="highlight"><pre><span></span><code><span class="c1"># On k8s master node</span>
<span class="nb">cd</span> /etc/kubernetes/manifests/
sudo vim kube-scheduler.yaml
<span class="c1"># Edit bind-address and port command options</span>
...
- --bind-address<span class="o">=</span><span class="m">0</span>.0.0.0
- --secure-port<span class="o">=</span><span class="m">10259</span>
...
</code></pre></div></p>
</li>
<li>
<p>Setup <code>controller-manager</code> metrics bind address
    <div class="highlight"><pre><span></span><code><span class="c1"># On k8s master node</span>
<span class="nb">cd</span> /etc/kubernetes/manifests/
sudo vim kube-controller-manager.yaml
<span class="c1"># Edit bind-address and port command options</span>
...
- --bind-address<span class="o">=</span><span class="m">0</span>.0.0.0
- --secure-port<span class="o">=</span><span class="m">10257</span>
...
</code></pre></div></p>
</li>
</ul>
<p>You should also check:
* TLS configuration of prometheus components responsible for scraping <code>controller-manager</code> and <code>scheduler</code>.
If you don't want to set up TLS, you can skip validation as shown <a href="https://github.com/dNationCloud/kubernetes-monitoring-stack/blob/main/helpers/values-kind.yaml">here</a>.</p>
<ul>
<li>Authorization to access <code>controller-manager</code> and <code>scheduler</code>. You can skip authorization for some endpoints 
  by setting <code>--authorization-always-allow-paths: "/healthz,/readyz,/livez,/metrics"</code> in <code>kubeadm_init.yaml</code> (<a href="https://github.com/dNationCloud/kubernetes-monitoring-stack/blob/main/helpers/kind_cluster_config.yaml">see example for kind cluster</a>) or 
  manually in already running K8s deployment by following same steps as above when setting metrics bind address.</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../docs/AWS_doc/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                AWS
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.0ac82a11.min.js"></script>
      <script src="../../assets/javascripts/bundle.f81dfb4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>